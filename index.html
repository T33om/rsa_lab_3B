<!DOCTYPE html>
<html lang="en" class="h-full">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>RSA Lab 3B ‚Äî OAEP & PSS</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" href="data:;base64,iVBORw0KGgo=" />
  </head>
  <body>
    <header>
      <h1>üîê RSA Lab 3B ‚Äî OAEP (Encrypt) &amp; PSS (Sign)</h1>
      <div class="muted" id="statusBar">
        Key size: <span id="keybits" class="badge">{{ key_bits }} bits</span> ‚Ä¢
        Max OAEP payload:
        <span id="maxpayload" class="badge">{{ max_payload }}</span> bytes ‚Ä¢
        Mode: <span id="mode" class="badge">random</span> ‚Ä¢ Private:
        <span id="haspriv" class="badge">yes</span>
      </div>
      <p class="muted small">
        RSA is for small data; use hybrid (RSA+AES) for files.
      </p>
    </header>

    <main>
      <!-- KEY SOURCE TABS -->
      <section class="card span2">
        <div class="tabs">
          <button class="tab active" id="tabRandom">Key Source: Random</button>
          <button class="tab" id="tabImport">Key Source: Import</button>
        </div>

        <!-- Random Keys Panel -->
        <div id="panelRandom">
          <div class="row">
            <label class="muted">Public Key (PEM)</label>
            <button
              id="btnDownload"
              title="Download the public key (safe to share)"
            >
              ‚¨áÔ∏è Download
            </button>
            <div class="row right">
              <select
                id="bits"
                title="Key size (bigger = more secure & slower)"
              >
                <option>2048</option>
                <option selected>3072</option>
                <option>4096</option>
              </select>
              <button id="btnRegen" title="Regenerate a fresh keypair">
                ‚ôªÔ∏è Regenerate
              </button>
            </div>
          </div>
          <pre id="pubpem"><code class="k">{{ pubkey_pem }}</code></pre>
          <p class="muted mt8">
            Regenerate creates a new keypair of the selected size. Larger keys
            are more secure but slower.
          </p>
        </div>

        <!-- Import Keys Panel -->
        <div id="panelImport" class="hidden">
          <p class="warn">
            ‚ö†Ô∏è Do not paste a real private key on the internet. Demo purpose
            only.
          </p>
          <div class="grid2">
            <div>
              <label class="muted">Public Key (PEM)</label>
              <textarea
                id="pub_in"
                rows="8"
                placeholder="-----BEGIN PUBLIC KEY-----&#10;...&#10;-----END PUBLIC KEY-----"
              ></textarea>
            </div>
            <div>
              <label class="muted">Private Key (PEM) ‚Äî optional</label>
              <textarea
                id="priv_in"
                rows="8"
                placeholder="-----BEGIN PRIVATE KEY-----&#10;...&#10;-----END PRIVATE KEY----- (optional)"
              ></textarea>
            </div>
          </div>
          <div class="row mt8">
            <button id="btnApply">Apply</button>
            <button id="btnBackRandom" title="Switch back to random keys">
              Use Random Mode
            </button>
          </div>
        </div>
      </section>

      <!-- OPERATION MODE TABS -->
      <section class="card span2">
        <div class="tabs">
          <button class="tab active" id="tabManual">
            Operation Mode: Manual
          </button>
          <button class="tab" id="tabLab">
            Operation Mode: Lab (One-Click)
          </button>
        </div>

        <!-- Manual Mode Panels -->
        <div id="panelManual">
          <div class="grid2">
            <section class="card">
              <h3>üîí Encrypt (RSA-OAEP)</h3>
              <textarea
                id="enc_input"
                rows="6"
                placeholder="Enter a short message to encrypt..."
              ></textarea>
              <div class="row mt8">
                <button id="btnEncrypt" title="Encrypt with the public key">
                  Encrypt
                </button>
                <span class="muted"
                  >Max <span id="limit">{{ max_payload }}</span> bytes</span
                >
                <span class="badge" id="enc_time">‚Äì ms</span>
              </div>
              <label class="muted">Ciphertext (base64):</label>
              <textarea id="enc_out" rows="6" readonly></textarea>
            </section>

            <section class="card">
              <h3>üîì Decrypt</h3>
              <textarea
                id="dec_input"
                rows="6"
                placeholder="Paste base64 ciphertext here..."
              ></textarea>
              <div class="row mt8">
                <button
                  id="btnDecrypt"
                  title="Decrypt with the private key (if available)"
                >
                  Decrypt
                </button>
                <span class="badge" id="dec_time">‚Äì ms</span>
              </div>
              <label class="muted">Plaintext:</label>
              <textarea id="dec_out" rows="6" readonly></textarea>
            </section>

            <section class="card">
              <h3>‚úçÔ∏è Sign (RSA-PSS)</h3>
              <textarea
                id="sign_input"
                rows="6"
                placeholder="Enter message to sign..."
              ></textarea>
              <div class="row mt8">
                <button
                  id="btnSign"
                  title="Sign with the private key (if available)"
                >
                  Sign
                </button>
                <span class="badge" id="sign_time">‚Äì ms</span>
              </div>
              <label class="muted">Signature (base64):</label>
              <textarea id="sign_out" rows="6" readonly></textarea>
            </section>

            <section class="card">
              <h3>üß™ Verify</h3>
              <textarea
                id="ver_msg"
                rows="4"
                placeholder="Enter message..."
              ></textarea>
              <textarea
                id="ver_sig"
                rows="4"
                placeholder="Paste base64 signature..."
              ></textarea>
              <div class="row mt8">
                <button id="btnVerify" title="Verify with the public key">
                  Verify
                </button>
                <span id="ver_status" class="muted"></span>
                <span class="badge" id="ver_time">‚Äì ms</span>
              </div>
            </section>
          </div>
        </div>

        <!-- Lab Mode Panel -->
        <div id="panelLab" class="hidden">
          <h3>üß™ Lab Mode ‚Äî One Click</h3>
          <textarea
            id="lab_msg"
            rows="4"
            placeholder="Type one message here..."
          ></textarea>
          <div class="row mt8">
            <button id="btnLabRun" title="Run all steps with one click">
              Run Demo
            </button>
          </div>
          <div class="grid2 mt8">
            <section class="card">
              <h4>Ciphertext</h4>
              <textarea id="lab_ct" rows="6" readonly></textarea>
              <div class="muted">
                Encrypt time: <span class="badge" id="lab_enc_ms">‚Äì ms</span>
              </div>
            </section>
            <section class="card">
              <h4>Decrypted</h4>
              <textarea id="lab_pt" rows="6" readonly></textarea>
              <div class="muted">
                Decrypt time: <span class="badge" id="lab_dec_ms">‚Äì ms</span>
              </div>
            </section>
            <section class="card">
              <h4>Signature</h4>
              <textarea id="lab_sig" rows="6" readonly></textarea>
              <div class="muted">
                Sign time: <span class="badge" id="lab_sign_ms">‚Äì ms</span>
              </div>
            </section>
            <section class="card">
              <h4>Verify</h4>
              <div id="lab_verify" class="muted"></div>
              <div class="muted">
                Verify time: <span class="badge" id="lab_ver_ms">‚Äì ms</span>
              </div>
            </section>
          </div>
          <p class="muted small mt8">
            Note: decrypt/sign require a private key. In public-only mode, those
            fields will be empty.
          </p>
        </div>
      </section>
    </main>

    <footer>
      Made for a classroom demo ‚Ä¢ RSA with OAEP &amp; PSS ‚Ä¢ Python + Flask +
      PyCryptodome
      <br />Built by <b>G1/3B</b>
    </footer>
    <script src="/static/app.js"></script>
  </body>
</html>
